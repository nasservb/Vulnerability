<template>
    <tailwind-th>
        <a href="#" @click.prevent="order">
            <slot></slot>
            <i class="fa fa-sort-amount-desc" aria-hidden="true" v-if="isOrder('DESC')"></i>
            <i class="fa fa-sort-amount-asc" aria-hidden="true" v-if="isOrder('ASC')"></i>
        </a>
    </tailwind-th>
</template>

<script>
    export default {
        props: {
            attr: { default: 'id' },
            query: { required: true },
        },
        methods: {
            isOrder(sort) {
                return _.has(this.query.orderBy, this.attr) && this.query.orderBy[this.attr] === sort;
            },
            order() {
                if (_.has(this.query.orderBy, this.attr)) {
                    if (this.query.orderBy[this.attr] === 'ASC') {
                        this.query.orderBy[this.attr] = 'DESC';
                    } else {
                        delete this.query.orderBy[this.attr];
                    }
                } else {
                    this.query.orderBy[this.attr] = 'ASC';
                }
                this.$emit('order');
            }
        }
    }
</script>